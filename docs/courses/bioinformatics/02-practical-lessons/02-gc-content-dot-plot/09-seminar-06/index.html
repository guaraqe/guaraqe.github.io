<!DOCTYPE html>
<html lang="en" data-theme="light">
<head profile="http://www.w3.org/2005/10/profile">
    <meta charset="UTF-8">
    <meta name="description" content="2.2.2 Subseries GC Content
 - Course material by Juan Raphael Diaz Simões">
    <meta name="author" content="Juan Raphael Diaz Simões">
    <meta name="keywords" content="Haskell, functional programming, software engineering, bioinformatics, performance optimization, Juan Simões">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="index, follow">
    <title>2.2.2 Subseries GC Content
</title>
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="2.2.2 Subseries GC Content
">
    <meta property="og:description" content="2.2.2 Subseries GC Content
 - Course material by Juan Raphael Diaz Simões">
    <meta property="og:url" content="https://guaraqe.github.io/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/09-seminar-06/index.html">
    <meta property="og:site_name" content="Juan Raphael Diaz Simões">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="2.2.2 Subseries GC Content
">
    <meta name="twitter:description" content="2.2.2 Subseries GC Content
 - Course material by Juan Raphael Diaz Simões">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://guaraqe.github.io/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/09-seminar-06/index.html">
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "2.2.2 Subseries GC Content
",
      "description": "2.2.2 Subseries GC Content
 - Course material by Juan Raphael Diaz Simões",
      "url": "https://guaraqe.github.io/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/09-seminar-06/index.html",
      "author": {
        "@type": "Person",
        "name": "Juan Raphael Diaz Simões",
        "jobTitle": "Software Engineer",
        "knowsAbout": ["Haskell", "Functional Programming", "Bioinformatics", "Performance Optimization"],
        "url": "https://guaraqe.github.io"
      },
      "inLanguage": "en-US"
    }
    </script>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link href="https://cdn.jsdelivr.net/npm/daisyui@3.1.0/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   var macros = [];
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      macros: macros,
      fleqn: false
     });
  }}});
    </script>

</head>
<body>
    <header>
        <div class="navbar no-print bg-base-100 px-4 py-3">
          <div class="navbar-start">
            <a href="/" class="flex items-center group">
              <img src="/images/juan.png" alt="Juan Simões" class="w-8 h-8 rounded-full object-cover mr-3 group-hover:scale-105 transition-transform">
              <span class="text-lg font-medium text-gray-800 group-hover:text-blue-600 transition-colors hidden sm:inline">Juan Raphael Diaz Simões</span>
              <span class="text-lg font-medium text-gray-800 group-hover:text-blue-600 transition-colors sm:hidden">Juan Simões</span>
            </a>
          </div>
          <div class="navbar-end">
            <div class="hidden sm:block">
              <ul class="menu menu-horizontal text-sm space-x-1">
                <li><a href="/posts" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">Writing</a></li>
                <li><a href="/courses" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">Teaching</a></li>
                <li><a href="/cv.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">CV</a></li>
                <li><a href="/projects.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">Projects</a></li>
              </ul>
            </div>
            <div class="block sm:hidden">
              <div class="grid grid-cols-2 gap-1 text-xs">
                <a href="/posts" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">Writing</a>
                <a href="/cv.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">CV</a>
                <a href="/courses" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">Teaching</a>
                <a href="/projects.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">Projects</a>
              </div>
            </div>
          </div>
        </div>
    </header>
    <div class="md:flex justify-center bg-base-100">
<article class="prose max-w-prose mb-5">
  <div class="book-navigation -mt-4">

    <div class="book-navigation-parent drawer">
      <input id="my-drawer" type="checkbox" class="drawer-toggle" />
      <div class="drawer-content">
        <label for="my-drawer" class="btn btn-outline btn-sm gap-2 cursor-pointer hover:btn-primary transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
          </svg>
          <span class="font-medium">Index</span>
        </label>
      </div>
      <div class="drawer-side">
        <label for="my-drawer" class="drawer-overlay"></label>
           <div class="menu menu-vertical p-4 bg-base-200">
             <h1 class="text-xl mb-5 w-100" style="margin-left: 0.75em;">
                  Introduction to Bioinformatics

             </h1>
             <div style="margin-left:-1.5em;">
               <ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/index.html">1 Lectures
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/03-lecture-01/index.html">1.1 Bioinformatics Basics
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/07-lecture-02/index.html">1.2 Comparing Gene Sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/10-lecture-03/index.html">1.3 Comparing Gene Sequences 2
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/13-lecture-04/index.html">1.4 Gene Finding
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/16-lecture-05/index.html">1.5 Locating genes and its functions: techniques, problems and difficulties
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/index.html">2 Practical Lessons
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/index.html">2.1 Basic R and generic data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/01-seminar-01/index.html">2.1.1 Basic R
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/02-seminar-02/index.html">2.1.2 Files
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/04-seminar-03/index.html">2.1.3 Gene Sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/05-seminar-04/index.html">2.1.4 Comparing Gene Sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/06-control-01/index.html">2.1.5 Control: Loading and processing data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/20-seminar-12/index.html">2.1.6 Programming Exercises
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/index.html">2.2 Basic analysis of genetic data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/08-seminar-05/index.html">2.2.1 GC Content
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/09-seminar-06/index.html">2.2.2 Subseries GC Content
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/10-seminar-06/index.html">2.2.3 Exercise: Comparing sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/11-seminar-07/index.html">2.2.4 Creating dot plots
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/14-control-02/index.html">2.2.5 Loading and comparing data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/index.html">2.3 Codons and gene finding
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/15-seminar-09/index.html">2.3.1 Translating bases to codons
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/17-seminar-10/index.html">2.3.2 Codon frequencies and finding genes
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/18-control-03/index.html">2.3.3 Theoretical Control
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/19-seminar-11/index.html">2.3.4 Aminoacid sequences and base sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/04-summary-and-exam/index.html">2.4 Summary and exam
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/04-summary-and-exam/21-seminar-13/index.html">2.4.1 Theoretical Questions
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/04-summary-and-exam/22-exam-01/index.html">2.4.2 Final exam
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li></ul></li></ul>
             </div>
           </div>
      </div>
    </div>

    <div class="book-navigation-parent">
      <a href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/index.html">↑ 2.2 Basic analysis of genetic data
</a>
    </div>

    <div class="book-navigation-section">

       <div class="book-navigation-previous">
         <a href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/08-seminar-05/index.html">2.2.1 GC Content
</a>
       </div>

       <div class="book-navigation-next">
         <a href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/10-seminar-06/index.html">2.2.3 Exercise: Comparing sequences
</a>
       </div>
    </div>

  </div>

    <h1 class="text-3xl mb-5">
    2.2.2 Subseries GC Content

</h1>

<p class="mb-3">In this course we will write functions to analyze the GC content of <em>subsequences</em> of a sequence. You can download the sequences right clicking the following link: <a class="link link-hover text-zinc-600" href="data/dengue.fasta">dengue</a> and choosing “Save as…”, saving in choose the <code>Bioinformatics/workspace</code> folder that is in the desktop, as always.</p>
<p class="mb-3">Before starting, load the data:</p>
<pre class="sourcecode"><code>library(seqinr)
dengue &lt;- read.fasta(&quot;dengue.fasta&quot;)[[1]]</code></pre>
<h1 class="text-2xl mt-5 mb-5" data-number="1" id="gc-content"><span class="header-section-number">1</span> GC Content</h1>
<p class="mb-3">In the last lecture we defined the GC content of a sequence manually, using the frequencies of <strong>G</strong> and <strong>C</strong> in the sequences. The library <code>seqinr</code> has a function that automatically calculates the GC content for any sequence.</p>
<pre class="sourcecode"><code>&gt; GC(dengue)
0.4666977</code></pre>
<p class="mb-3">We will use this function instead today.</p>
<h1 class="text-2xl mt-5 mb-5" data-number="2" id="selecting-windows"><span class="header-section-number">2</span> Selecting windows</h1>
<p class="mb-3">Different parts of the DNA strand behave differently. It is useful to be able to select subparts of it. For example, to select the first 10 nucleotides:</p>
<pre class="sourcecode"><code>&gt; dengue[1:10]
[1] &quot;a&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;g&quot; &quot;t&quot; &quot;t&quot; &quot;a&quot; &quot;g&quot; &quot;t&quot;</code></pre>
<p class="mb-3">To select <code>n</code> nucleotides, starting from the position <code>s</code>, the operation to be used is <code>dengue[s,(s+n-1)]</code>.</p>
<h1 class="text-2xl mt-5 mb-5" data-number="3" id="choosing-some-windows"><span class="header-section-number">3</span> Choosing some windows</h1>
<p class="mb-3">Let’s analyze the data for two windows of size 100. We will get the GC content for each slice, and save it in an vector.</p>
<pre class="sourcecode"><code>#reate and empty vector
gc &lt;- c()
#ave the first element
gc[1] &lt;- GC(dengue[1:100])
#ave the second element
gc[2] &lt;- GC(dengue[101:200])</code></pre>
<p class="mb-3">Now we have a vector:</p>
<pre class="sourcecode"><code>&gt; gc
[1] 0.40 0.48</code></pre>
<p class="mb-3">Which we can plot with <code>barplot(gc)</code>. But how can we do this for all intervals of a given size in a sequence?</p>
<h1 class="text-2xl mt-5 mb-5" data-number="4" id="getting-all-the-intervals"><span class="header-section-number">4</span> Getting all the intervals</h1>
<p class="mb-3">We want to obtain an array such as <code>c(1,101,201,301...)</code>, corresponding to the <strong>start</strong> points for the intervals. but that is too long to write by hand. We will use instead the function <code>seq(start,end,by=size)</code> where <code>start</code> is the first element we want, <code>end</code> the last one, and <code>size</code> the size of the interval between elements.</p>
<p class="mb-3">In the example above, we want:</p>
<pre class="sourcecode"><code>size(1,length(dengue)-100,by=100)</code></pre>
<h1 class="text-2xl mt-5 mb-5" data-number="5" id="going-through-all-the-elements"><span class="header-section-number">5</span> Going through all the elements</h1>
<p class="mb-3">To go through all the elements, we will use a <code>for</code> loop. For example, to print all the elements in the vector <code>1:100</code>:</p>
<pre class="sourcecode"><code>for(i in 1:100) {
  print(i)
}</code></pre>
<h1 class="text-2xl mt-5 mb-5" data-number="6" id="final-result"><span class="header-section-number">6</span> Final result</h1>
<p class="mb-3">Putting everything together, we can write a function that results into a vector containing the GC content of each piece of the sequence.</p>
<pre class="sourcecode"><code>windowGC &lt;- function(data, window) {
  starts &lt;- seq(1,length(data)-window,by=window)
  gc &lt;- c()
  for(i in 1:length(starts)) {
    start &lt;- starts[i]
    end &lt;- start+window-1
    gc[i] &lt;- GC(data[start:end])
  }
  gc
}</code></pre>
<p class="mb-3">To calculate for windows of size 1000:</p>
<pre class="sourcecode"><code>&gt; windowGC(dengue,1000)
[1] 0.477 0.453 0.464 0.441 0.471 0.470 0.488 0.470 0.438 0.471
&gt; barplot(windowGC(dengue,1000))</code></pre>
<p class="mb-3"><img class="mx-auto" src="data/168364e27ee6e0dc681bf322607d446d.png" /></p>
<p class="mb-3">The function above can be used to compare different window sizes. By decreasing the window size, we can see the GC content with more resolution. Try generating each one of these graphs.</p>
<p class="mb-3"><img class="mx-auto" src="data/c1e1d16948eee263d8373a848e960783.png" /></p>
<p class="mb-3">Looking at this graph, what part of the DNA would break first when heating it?</p>

  <ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul>


    <div class="google-translate-container">
      <div id="google_translate_element"></div>
    </div>

</article>
  <script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'en',
      autoDisplay: false,
      includedLanguages: 'en,ru,uz',
    }, 'google_translate_element');
  }
  </script>

  <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</div>

</body>
</html>
