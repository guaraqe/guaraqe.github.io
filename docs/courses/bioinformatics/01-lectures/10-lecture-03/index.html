<!DOCTYPE html>
<html lang="en">
<head profile="http://www.w3.org/2005/10/profile">
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <title>1.3 Comparing Gene Sequences 2
</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link href="https://cdn.jsdelivr.net/npm/daisyui@3.1.0/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   var macros = [];
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      macros: macros,
      fleqn: false
     });
  }}});
    </script>

</head>
<body>
    <header>
        <div class="navbar bg-base-100 px-4 py-3">
          <div class="navbar-start">
            <a href="/" class="flex items-center group">
              <img src="/images/juan.png" alt="Juan Simões" class="w-8 h-8 rounded-full object-cover mr-3 group-hover:scale-105 transition-transform">
              <span class="text-lg font-medium text-gray-800 group-hover:text-blue-600 transition-colors hidden sm:inline">Juan Raphael Diaz Simões</span>
              <span class="text-lg font-medium text-gray-800 group-hover:text-blue-600 transition-colors sm:hidden">Juan Simões</span>
            </a>
          </div>
          <div class="navbar-end">
            <div class="hidden sm:block">
              <ul class="menu menu-horizontal text-sm space-x-1">
                <li><a href="/posts" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">Writing</a></li>
                <li><a href="/courses" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">Education</a></li>
                <li><a href="/cv.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">CV</a></li>
                <li><a href="/projects.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors">Projects</a></li>
              </ul>
            </div>
            <div class="block sm:hidden">
              <div class="grid grid-cols-2 gap-1 text-xs">
                <a href="/posts" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">Writing</a>
                <a href="/cv.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">CV</a>
                <a href="/courses" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">Education</a>
                <a href="/projects.html" class="hover:bg-gray-100 rounded-md px-2 py-1 transition-colors text-center">Projects</a>
              </div>
            </div>
          </div>
        </div>
    </header>
    <div class="md:flex justify-center bg-base-100">
<article class="prose max-w-prose mb-5">
  <div class="book-navigation">

    <div class="book-navigation-parent drawer">
      <input id="my-drawer" type="checkbox" class="drawer-toggle" />
      <div class="drawer-content">
        <label for="my-drawer">
          <div class="space-y-1 inline-block">
            <div class="w-4 h-0.5 bg-gray-600"></div>
            <div class="w-4 h-0.5 bg-gray-600"></div>
            <div class="w-4 h-0.5 bg-gray-600"></div>
          </div>
          <b>Index</b>
        </label>
      </div>
      <div class="drawer-side">
        <label for="my-drawer" class="drawer-overlay"></label>
           <div class="menu menu-vertical p-4 bg-base-200">
             <h1 class="text-xl mb-5 w-100" style="margin-left: 0.75em;">
                  Introduction to Bioinformatics

             </h1>
             <div style="margin-left:-1.5em;">
               <ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/index.html">1 Lectures
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/03-lecture-01/index.html">1.1 Bioinformatics Basics
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/07-lecture-02/index.html">1.2 Comparing Gene Sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/10-lecture-03/index.html">1.3 Comparing Gene Sequences 2
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/13-lecture-04/index.html">1.4 Gene Finding
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/01-lectures/16-lecture-05/index.html">1.5 Locating genes and its functions: techniques, problems and difficulties
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/index.html">2 Practical Lessons
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/index.html">2.1 Basic R and generic data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/01-seminar-01/index.html">2.1.1 Basic R
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/02-seminar-02/index.html">2.1.2 Files
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/04-seminar-03/index.html">2.1.3 Gene Sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/05-seminar-04/index.html">2.1.4 Comparing Gene Sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/06-control-01/index.html">2.1.5 Control: Loading and processing data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/01-basic-r-and-fasta/20-seminar-12/index.html">2.1.6 Programming Exercises
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/index.html">2.2 Basic analysis of genetic data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/08-seminar-05/index.html">2.2.1 GC Content
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/09-seminar-06/index.html">2.2.2 Subseries GC Content
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/10-seminar-06/index.html">2.2.3 Exercise: Comparing sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/11-seminar-07/index.html">2.2.4 Creating dot plots
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/02-gc-content-dot-plot/14-control-02/index.html">2.2.5 Loading and comparing data
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/index.html">2.3 Codons and gene finding
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/15-seminar-09/index.html">2.3.1 Translating bases to codons
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/17-seminar-10/index.html">2.3.2 Codon frequencies and finding genes
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/18-control-03/index.html">2.3.3 Theoretical Control
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/03-codons-and-gene-finding/19-seminar-11/index.html">2.3.4 Aminoacid sequences and base sequences
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/04-summary-and-exam/index.html">2.4 Summary and exam
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/04-summary-and-exam/21-seminar-13/index.html">2.4.1 Theoretical Questions
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li><li><a class="link link-hover text-zinc-600" href="/courses/bioinformatics/02-practical-lessons/04-summary-and-exam/22-exam-01/index.html">2.4.2 Final exam
</a><ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul></li></ul></li></ul></li></ul>
             </div>
           </div>
      </div>
    </div>

    <div class="book-navigation-parent">
      <div class="arrow arrow-up"></div>
      <a href="/courses/bioinformatics/01-lectures/index.html">1 Lectures
</a>
      <div class="arrow arrow-up"></div>
    </div>

    <div class="book-navigation-section">

       <div class="book-navigation-previous">
         <div class="arrow arrow-left"></div>
         <a href="/courses/bioinformatics/01-lectures/07-lecture-02/index.html">1.2 Comparing Gene Sequences
</a>
       </div>

       <div class="book-navigation-next">
         <a href="/courses/bioinformatics/01-lectures/13-lecture-04/index.html">1.4 Gene Finding
</a>
         <div class="arrow arrow-right"></div>
       </div>
    </div>

    <div id="google_translate_element" style="margin-top:1em;"></div>

  </div>

    <h1 class="text-3xl mb-5">
    1.3 Comparing Gene Sequences 2

</h1>

<h1 class="text-2xl mt-5 mb-5" data-number="1" id="context"><span class="header-section-number">1</span> Context</h1>
<h2 class="text-xl mt-5 mb-5" data-number="1.1" id="sequences"><span class="header-section-number">1.1</span> Sequences</h2>
<p class="mb-3">DNA is composed of four bases adenine (<strong>A</strong>), guanine (<strong>G</strong>), cytosine (<strong>C</strong>) and thymine (<strong>T</strong>). The bases of DNA determines the RNA it can encode, and therefore the proteins in can enduce production of.</p>
<p class="mb-3"><img class="mx-auto" src="data/1b1f5ce9f25913897c5ae987912331cd.png" /></p>
<p class="mb-3">Given two sequences, how can we determine in which aspects they are <strong>different</strong> or <strong>similar</strong>? Last time we started studying dot plots.</p>
<h1 class="text-2xl mt-5 mb-5" data-number="2" id="dot-plots"><span class="header-section-number">2</span> Dot plots</h1>
<h2 class="text-xl mt-5 mb-5" data-number="2.1" id="what-is-a-dot-plot"><span class="header-section-number">2.1</span> What is a dot plot</h2>
<p class="mb-3">A dot plot is a graphical method for comparing two biological sequences and identifying regions of close similarity after sequence alignment. It is one of the oldest techniquest for comparing base sequences.</p>
<p class="mb-3">The technique is the following. Build a graph with two axis, with one gene sequence in each axis. In the position <code>(i,j)</code> put a black dot if the base in the position <code>i</code> of the first sequence is the same as the base in the position <code>j</code> in the second sequence. Othewise, put a white dot.</p>
<p class="mb-3"><img class="mx-auto" src="data/983b437ea763b2228443d2be2ad544dd.png" /></p>
<h2 class="text-xl mt-5 mb-5" data-number="2.2" id="how-to-make-a-dot-plot"><span class="header-section-number">2.2</span> How to make a dot plot</h2>
<p class="mb-3">In R, is is possible to make a dot plot using the <code>seqinr</code> library. To do a dot plot for a small part of the dengue gene:</p>
<pre class="sourcecode"><code>&gt; shortDengue &lt;- dengue[1:100]
&gt; dotPlot(shortDengue,shortDengue)</code></pre>
<p class="mb-3">Why a small section? Dot plots are expensive to calculate. For 100 bases, one needs 10,000 operations. For 10,000 bases, one needs 100,000,000 operations. It grows very fast, so it can take a long time to calculate.</p>
<p class="mb-3"><img class="mx-auto" src="data/00ce6669265d5e06ec115509582cc3cc.png" /></p>
<h2 class="text-xl mt-5 mb-5" data-number="2.3" id="comparing-the-full-sequence"><span class="header-section-number">2.3</span> Comparing the full sequence</h2>
<p class="mb-3">When comparing the full dengue sequence with itself, the result is the following. It took around 20 minutes to calculate in my computer, so it is not practical to do during classes.</p>
<p class="mb-3">It also shows another limitation of dot plots – when they are very large, it is difficult to interpret the result, since lines are difficult to see.</p>
<p class="mb-3"><img class="mx-auto" src="data/020eeab53cadec564debb6dbc2bdf69f.png" /></p>
<h2 class="text-xl mt-5 mb-5" data-number="2.4" id="creating-a-dot-plot-1"><span class="header-section-number">2.4</span> Creating a dot plot 1</h2>
<p class="mb-3">A sequence with itself.</p>
<p class="mb-3"><img class="mx-auto" src="data/ba92d9e96f701a562c9e114a13a0019c.png" /></p>
<h2 class="text-xl mt-5 mb-5" data-number="2.5" id="comparing-two-sequences"><span class="header-section-number">2.5</span> Comparing two sequences</h2>
<p class="mb-3">Besides comparing a sequence with itself, we can compare two different sequences:</p>
<pre class="sourcecode"><code>&gt; shortZika &lt;- zika[1:100]
&gt; dotPlot(shortDengue,shortZika)</code></pre>
<p class="mb-3"><img class="mx-auto" src="data/536788fb6455178c3f33cebd52c681d2.png" /></p>
<h2 class="text-xl mt-5 mb-5" data-number="2.6" id="creating-a-dot-plot-2"><span class="header-section-number">2.6</span> Creating a dot plot 2</h2>
<p class="mb-3">A sequence with another sequence.</p>
<p class="mb-3"><img class="mx-auto" src="data/0125e225b6d974825cf2cbdf33010161.png" /></p>
<h1 class="text-2xl mt-5 mb-5" data-number="3" id="alignment"><span class="header-section-number">3</span> Alignment</h1>
<h2 class="text-xl mt-5 mb-5" data-number="3.1" id="sequence-alignment"><span class="header-section-number">3.1</span> Sequence alignment</h2>
<p class="mb-3">An important question is how much two sequences are similar. To quantify similarity, it is necessary to <em>align</em> the two sequences, and then you can calculate a similarity score based on the alignment.</p>
<p class="mb-3">There are two types of alignment in general. A <em>global</em> alignment is an alignment of the full length of two sequences, for example, of two protein sequences or of two DNA sequences. A <em>local</em> alignment is an alignment of part of one sequence to part of another sequence.</p>
<h2 class="text-xl mt-5 mb-5" data-number="3.2" id="sequence-transformations"><span class="header-section-number">3.2</span> Sequence transformations</h2>
<p class="mb-3">When comparing sequences, we consider possible events that may happen in the sequences. For example, <em>base deletion</em> or <em>base insertion</em>. This means we may introduce gaps in the sequences. We represent gaps with. <code>-</code>.</p>
<p class="mb-3">For example, when comparing the sequences <code>GAATTC</code> and <code>GATTA</code>, we may want to also consider:</p>
<pre><code>G A A T T C
G A T T - A</code></pre>
<p class="mb-3">and</p>
<pre><code>G A A T T C
G A - T T A</code></pre>
<h2 class="text-xl mt-5 mb-5" data-number="3.3" id="evaluating-alignments"><span class="header-section-number">3.3</span> Evaluating alignments</h2>
<p class="mb-3">To evaluate the alignment, we give points to pairings, for example:</p>
<ul class="list-disc list-outside mt-1 mb-3 pl-5">
<li>Match: 2 points</li>
<li>Mismatch: -1 points</li>
<li>Gap: -2 points</li>
</ul>
<p class="mb-3"> </p>
<pre><code>G A  A T  T  C
G A  T T  -  A
2 2 -1 2 -2 -1 = 2</code></pre>
<p class="mb-3">and</p>
<pre><code>G A  A T T C
G A  - T T A
2 2 -2 2 2 -1 = 5</code></pre>
<h2 class="text-xl mt-5 mb-5" data-number="3.4" id="aligning-sequences"><span class="header-section-number">3.4</span> Aligning sequences</h2>
<p class="mb-3">Find the best alignment for <code>GATTA</code> and <code>CATA</code>. Where should the gap go?</p>
<pre><code>G A T T A
- C A T A
C - A T A
C A - T A
C A T - A
C A T A -</code></pre>
<h1 class="text-2xl mt-5 mb-5" data-number="4" id="alignment-using-r"><span class="header-section-number">4</span> Alignment using R</h1>
<h2 class="text-xl mt-5 mb-5" data-number="4.1" id="matching-matrix"><span class="header-section-number">4.1</span> Matching matrix</h2>
<p class="mb-3">We can use R to determine the best pairwise alignment between two sequences, using the <code>Biostrings</code> library. In order to do so, we first tell how we want to evaluate matches and mismatches. This uses the <code>nucleotideSubstitutionMatrix</code>:</p>
<pre class="sourcecode"><code>&gt; library(Biostrings)
&gt; sigma &lt;- nucleotideSubstitutionMatrix(match = 2, mismatch = -1, baseOnly = TRUE)
&gt; sigma
   A  C  G  T
A  2 -1 -1 -1
C -1  2 -1 -1
G -1 -1  2 -1
T -1 -1 -1  2</code></pre>
<h2 class="text-xl mt-5 mb-5" data-number="4.2" id="finding-the-best-alignment"><span class="header-section-number">4.2</span> Finding the best alignment</h2>
<p class="mb-3">To calculate the best alignment, we use the function <code>pairwiseAlignment</code>, which takes the matrix above as a parameter. This uses the Needleman-Wunch algorithm.</p>
<pre class="sourcecode"><code>&gt; s1 &lt;- &quot;GAATTC&quot;
&gt; s2 &lt;- &quot;GATTA&quot;
&gt; pairwiseAlignment(s1, s2, substitutionMatrix = sigma, gapOpening = -8, gapExtension = -2, scoreOnly = FALSE)
Global Pairwise Alignment (1 of 1)
pattern: GAATTC
subject: GA-TTA
score: -3</code></pre>
<h2 class="text-xl mt-5 mb-5" data-number="4.3" id="gap-evaluation"><span class="header-section-number">4.3</span> Gap evaluation</h2>
<p class="mb-3">The function had two extra parameters, <code>gapOpening</code> and <code>gapExtension</code>. These correspond to how we evaluate gaps:</p>
<ul class="list-disc list-outside mt-1 mb-3 pl-5">
<li><code>gapOpening</code> is the value for the first space in the gap</li>
<li><code>gapExtension</code> is the value for the subsequent spaces in the gap</li>
</ul>
<p class="mb-3">This is because a single gap of two nucleotides</p>
<h2 class="text-xl mt-5 mb-5" data-number="4.4" id="gap-evaluation-1"><span class="header-section-number">4.4</span> Gap evaluation</h2>
<p class="mb-3">For example, if we give the values <code>-8</code> and <code>-2</code> for gap openins and extensions, if we compare <code>ATAG</code> and <code>AA</code>, we have:</p>
<pre><code>A  T A  G
A  - A  -
2 -8 2 -8 = -12</code></pre>
<p class="mb-3">and</p>
<pre><code>A  T  A  G
A  A  -  -
2 -2 -8 -2 = -10</code></pre>
<h2 class="text-xl mt-5 mb-5" data-number="4.5" id="aligning-the-exercise-in-r"><span class="header-section-number">4.5</span> Aligning the exercise in R</h2>
<p class="mb-3">In the example we did manually:</p>
<pre class="sourcecode"><code>&gt; s1 &lt;- &quot;GATTA&quot;
&gt; s2 &lt;- &quot;CATA&quot;
&gt; pairwiseAlignment(s1, s2, substitutionMatrix = sigma, gapOpening = -8, gapExtension = -2, scoreOnly = FALSE)
Global PairwiseAlignmentsSingleSubject (1 of 1)
pattern: GATTA
subject: CAT-A
score: -5 </code></pre>
<h1 class="text-2xl mt-5 mb-5" data-number="5" id="next"><span class="header-section-number">5</span> Next</h1>
<h2 class="text-xl mt-5 mb-5" data-number="5.1" id="next-lectures"><span class="header-section-number">5.1</span> Next lectures</h2>
<p class="mb-3">In the next two lectures we will study:</p>
<ul class="list-disc list-outside mt-1 mb-3 pl-5">
<li>Producing dot plots</li>
<li>Aligning sequences using R</li>
</ul>
<h2 class="text-xl mt-5 mb-5" data-number="5.2" id="questions"><span class="header-section-number">5.2</span> Questions?</h2>

  <ul class="list-disc list-outside mt-1 mb-3 pl-5"></ul>


</article>
  <script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'en',
      autoDisplay: false,
      includedLanguages: 'en,ru,uz',
    }, 'google_translate_element');
  }
  </script>

  <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</div>

</body>
</html>
